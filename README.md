# PHP Web Site Optimization

**Author:** Greg Weir  
**Course Code:** phpopt  

> _Can I use your material_

---

## What is Optimization?

- Reducing resource utilization  
- Improving response time  
  - Sometimes there is a tradeoff between the two, increasing utilization to reduce response time  
- In this course, general techniques for any PHP application are covered  
  - For some specialized applications, (e.g. WordPress) additional subject matter training is recommended  

---

## The Optimization Process

1. Create a well-instrumented test  
   - Time metrics are absolutely required  
   - Some resource utilization metrics are needed, others may not be  
   - Re-using existing monitoring metrics is a good practice, but in some cases they may not be enough  
2. Run the test (establish a baseline)  
3. Make a change  
   - Identify possible sources of delay  
   - Make *one* change (e.g. optimize a SQL query, tweak a script, add cache, add hardware)  
4. Repeat test and record results  

---

## Recommended Tools

- **Apache JMeter**  
  - [JMeter Course Info](http://training-course-material.com/index.php?title=Category:JMeter)  
  - [JMeter Website](http://jmeter.apache.org/)  
- **xdebug**  
  - [https://xdebug.org/](https://xdebug.org/)  
  - Debugging extension for PHP with a built-in profiler for performance data  
- **Cachegrind GUI**  
  - Works with performance data generated by xdebug  
  - Versions available for Linux, Windows, and macOS  

---

## Opcode Caching

- Built-in to all versions of PHP since 5.5 by default  
  - Similar optimization previously offered by Zend Optimizer  
- Parameters for built-in caching can be manipulated using the [OPcache Module](http://php.net/manual/en/book.opcache.php)  

---

## Interprocess Communication

- IPC is any means of storing variables or sending signals between processes  

  **Legacy forms of IPC:**
  - Shared Memory (shmop)
  - Flat file
  - Temp tables in databases

  **Best practice IPC tools:**
  - memcached
  - Redis
  - ZeroMQ, RabbitMQ, beanstalkd
  - Gearman

---

## Parallel Processing

- PHP is synchronous by design and not intended for multithreading  

  **Parallel Processing Techniques:**
  - `curl_multi` or sockets — suitable for small numbers of operations  
  - `popen()` or `exec()` — requires custom code, but easy to implement  
  - Forking (`pcntl_fork`) — advanced technique  
  - Task queueing — essential for large scale and easier debugging  

---

## Database Optimization

- Know how to enable query logging and caching  
- Understand database basics: keys, joins, table scans, functions  

  **Optimizing a Query:**
  - Examine each table (MySQL: `DESCRIBE tbl_name`, PostgreSQL: `\d+ tbl_name`)  
  - Use `EXPLAIN`:  
    - [MySQL EXPLAIN](http://dev.mysql.com/doc/refman/5.7/en/explain.html)  
    - [PostgreSQL EXPLAIN](https://www.postgresql.org/docs/9.1/static/sql-explain.html)  
  - Can existing keys be used more effectively?  
  - Can subqueries be reduced or reused?  
  - Are unnecessary columns being retrieved?  
  - Can new indexes be created to improve performance?  

## Resources PHP

[PHP webiste](https://www.php.net)

[PHP Training | NobleProg](https://www.nobleprog.com.ph/php-training)
